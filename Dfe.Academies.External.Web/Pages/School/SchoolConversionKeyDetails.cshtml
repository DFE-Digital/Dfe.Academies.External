@page
@using Dfe.Academies.External.Web.Enums
@using Dfe.Academies.External.Web.ViewModels
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model Dfe.Academies.External.Web.Pages.School.SchoolConversionKeyDetailsModel
@{
	ViewData["Title"] = "Apply to become an academy - About the conversion";
}

@section BeforeMain
{
	<partial name="Shared/_BackLink" model='new BackViewModel { ApplicationId = Model.ApplicationId, SchoolURN = Model.Urn, ApplicationType = Model.ApplicationType }'/>
}

<div class="govuk-grid-column-two-thirds">
	<span class="govuk-caption-l">
		@Model.SchoolName
	</span>
	<h1 class="govuk-heading-l">
		About the conversion
	</h1>

    @*    <p id="summaryTableDescription" class="govuk-body">About the conversion Summary</p>*@
	@foreach (var component in Model.ViewModel)
	{
		<h2 class="govuk-heading-m">
			@component.Title
		</h2>
        <table class="govuk-table" aria-describedby="summaryTableDescription">
			<thead>
				<tr>
					<th scope="col"></th>
					<th scope="col"></th>
				</tr>
			</thead>
			<tbody class="govuk-table__body">
			<tr class="govuk-table__row">
				<td class="govuk-table__cell">
					@if (component.Status == SchoolConversionComponentStatus.NotStarted)
					{
						<a asp-page="@component.URI" aria-describedby="component-not started" class="govuk-button govuk-button--secondary"
						   asp-route-appId="@Model.ApplicationId"
						   asp-route-urn="@Model.Urn">
							Start section
						</a>
					}
					else
					{
						<a asp-page="@component.URI" aria-describedby="component-change" class="govuk-link"
						   asp-route-appId="@Model.ApplicationId"
						   asp-route-urn="@Model.Urn">
							Change your answers
						</a>
					}
				</td>
				<td class="govuk-table__cell"></td>
			</tr>
			@*render partial <tr> for each component.Section*@
			@foreach (var conversionComponent in component.Sections)
			{
				<partial name="_SchoolConversionComponentPartial" model="@conversionComponent"/>
			}

			</tbody>
		</table>  
		<div class="govuk-!-margin-6"></div>
	}

    <partial name="Shared/_BackButton" model='new BackViewModel { ApplicationId = Model.ApplicationId, SchoolURN = Model.Urn, ApplicationType = Model.ApplicationType }'/>
    
</div>
<input type="hidden" asp-for="Urn"/>
<partial name="_HiddenFields"/>