@page
@model Dfe.Academies.External.Web.Pages.AddAContributorModel
@using Dfe.Academies.External.Web.Enums
@using Dfe.Academies.External.Web.Extensions
@using Microsoft.AspNetCore.Mvc.TagHelpers
@{
	ViewData["Title"] = "Apply to become an academy - Add a contributor";
}

@section BeforeMain
{
    <a asp-page="ApplicationOverview" asp-route-appId="@Model.ApplicationId" class="govuk-back-link">
		Back to about the conversion
	</a>
}

<div class="govuk-grid-column-two-thirds">
    @if (Model.ShowConfirmationBox)
    {
	    <div class="govuk-notification-banner govuk-notification-banner--success" role="alert" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
		    <div class="govuk-notification-banner__header">
			    <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
				    Invitation Email sent
			    </h2>
		    </div>
		    <div class="govuk-notification-banner__content">
			    <h3 class="govuk-notification-banner__heading">
				    The new contributors name will now appear here and in the application overview and that person can now access this application.
			    </h3>
		    </div>
	    </div>
    }

	<h1 class="govuk-heading-l">
		Invite a contributor
	</h1>

	<p class="govuk-body-m">You can invite people to help you complete your application by providing their email address, name and role.</p>

	<p class="govuk-body-m">They must have a DfE Signin account</p>

	<form method="post" name="frmAddContributor" novalidate="">
		@Html.AntiForgeryToken()
		<input type="hidden" asp-for="ApplicationId"/>
		<partial name="_HiddenFields"/>

		<div class="govuk-form-group">
			<label for="EmailAddress" class="govuk-heading-m">What is the email address of the person you want to invite?</label>
			<input type="email" asp-for="EmailAddress" id="EmailAddress" class="govuk-input govuk-input--width-20"/>
		</div>

		<div class="govuk-form-group">
			<label for="Name" class="govuk-heading-m">What is the name of the person you want to invite?</label>
			<input type="text" asp-for="Name" id="Name" class="govuk-input govuk-input--width-20"/>
		</div>

		<div class="govuk-form-group">
			<fieldset class="govuk-fieldset">
				<h2 class="govuk-heading-m">What is their role?</h2>
				<div class="govuk-form-group">
					<div class="govuk-radios govuk-radios--conditional" data-module="govuk-radios">
						@foreach (var roleType in Model.RolesToDisplay)
						{
							<div class="govuk-radios__item">
								<input type="radio"
								       asp-for="ContributorRole"
								       value="@Convert.ToInt32(roleType)"
								       id="RoleType@(roleType)"
								       class="govuk-radios__input"
								       data-aria-controls="conditional-role-@(roleType.ToString().ToLower())"
								       checked="@(roleType.Equals(Model.ContributorRole))"
								       aria-expanded="False"/>
								<label for="RoleType@(roleType)" class="govuk-label govuk-radios__label">
									@roleType.GetDescription()
								</label>
							</div>
							@if (roleType == SchoolRoles.Other)
							{
								<div class="@(Model.OtherRoleError ? "govuk-form-group--error" : "govuk-radios__conditional")
                                            @(Model.ContributorRole != SchoolRoles.Other ? "govuk-radios__conditional--hidden" : "")"
								     id="conditional-role-other" aria-expanded="false">
									<div class="govuk-form-group govuk-error-summary__list">
										<label for="conditional-role-other" class="govuk-label">What is your role?</label>
										<a href="#OtherRoleNotEntered" class="@(Model.OtherRoleError ? "govuk-error-message" : "govuk-visually-hidden")">
											You must give your role
										</a>
										<input type="text" asp-for="OtherRoleNotListed" id="OtherRoleNotListed" class="govuk-input govuk-input--width-20" maxlength="100"/>
									</div>
								</div>
							}
						}
					</div>
				</div>
			</fieldset>

		</div>

		<input type="submit" value="Send invite" class="govuk-button govuk-!-margin-top-2 govuk-!-margin-bottom-8"/>
	</form>

	<div class="govuk-form-group">
		<h2 class="govuk-heading-m">Current contributors</h2>
		<partial name="_ApplicationContributorsPartial" model="Model.ExistingContributors"/>
	</div>
</div>